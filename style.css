/* style.css - Final Layout Fix (Central Feedback & Card Share) */

@import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css");

/* 1. 폰트 설정 */
@font-face { font-family: 'SF Pro'; src: url('SF-Pro.ttf') format('truetype'); font-weight: normal; }
@font-face { font-family: 'ONE Mobile POP'; src: url('ONE Mobile POP.ttf') format('truetype'), url('ONE Mobile POP OTF.otf') format('opentype'); font-weight: normal; }

/* 2. 변수 설정 */
:root {
    --text-primary: #101828;
    --text-secondary: #667085;
    --bg-color: #FFFFFF;
    --header-bg: rgba(245, 245, 245, 0.85);
    --chat-bg-bot: #F2F4F7;
    --chat-bg-user: #FFF4C9; 
    --accent-color: #FDB022;
    
    /* 글래스모피즘 효과 */
    --glass-bg: rgba(240, 242, 245, 0.70); 
    --glass-blur: blur(10px);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    font-family: 'SF Pro', 'Pretendard', sans-serif;
    background-color: #f9fafb; margin: 0; padding: 0;
    display: flex; justify-content: center; height: 100dvh; overflow: hidden;
    color: var(--text-primary);
}

.chat-container {
    width: 100%; max-width: 600px; height: 100%; background-color: var(--bg-color);
    position: relative; overflow: hidden; box-shadow: 0 0 25px rgba(0,0,0,0.05);
}

/* 3. 헤더 */
.chat-header {
    position: absolute; top: 0; left: 0; right: 0; z-index: 100;
    background-color: var(--glass-bg);
    backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
    border-bottom: 1px solid rgba(0,0,0,0.05);
    padding: 15px 0; text-align: center;
    display: flex; justify-content: center; align-items: center; gap: 12px;
}
.chat-header h2 {
    margin: 0; font-size: 1.45rem; font-weight: normal; color: var(--text-primary);
    font-family: 'ONE Mobile POP', sans-serif; display: flex; align-items: center; gap: 8px;
}
.header-icon { width: 40px; height: 40px; object-fit: cover; display: block; }

/* 4. 채팅 영역 */
.chat-box {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    padding: 80px 16px; 
    overflow-y: auto; background-color: var(--bg-color);
    display: flex; flex-direction: column; scroll-behavior: smooth;
}
.chat-box::-webkit-scrollbar { display: none; }

/* 5. 메시지 레이아웃 */
.message-row {
    display: flex; align-items: flex-start; margin-bottom: 12px; width: 100%; 
    animation: fadeInUp 0.3s ease-out forwards;
}
@keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.message-row.assistant { justify-content: flex-start; }
.message-row.user { justify-content: flex-end; }

.bot-profile-icon {
    width: 38px; height: 38px; margin-right: 10px; object-fit: cover; flex-shrink: 0;
    background-color: transparent; border: none; box-shadow: none;
}

.message {
    padding: 10px 15px; border-radius: 18px; max-width: 82%;
    font-size: 15px; line-height: 1.5; word-wrap: break-word; position: relative;
    margin: 0 !important;
}
.message p { margin: 0; }

.message.assistant { background-color: var(--chat-bg-bot); color: var(--text-primary); border-top-left-radius: 4px; }
.message.user { background-color: var(--chat-bg-user); color: var(--text-primary); border-top-right-radius: 4px; }

.message.assistant strong { font-weight: 700; color: #000; }
.message.assistant ul { padding-left: 20px; margin: 4px 0; }
.message.assistant li { margin-bottom: 4px; }

/* --- [수정] 카드 스타일 (공유 버튼 포함) --- */
.result-card {
    background-color: #FFFFFF;
    border: 1px solid #E4E7EC;
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    box-shadow: none;
}
/* [수정] 카드 카테고리 배지 (파란색 -> 베이지/아이보리 계열) */
.card-header-badge {
    display: inline-block;
    font-size: 12px;
    font-weight: bold;
    
    /* [변경 1] 글자색: 진한 갈색/따뜻한 회색 */
    color: #6B5B45; 
    
    /* [변경 2] 배경색: 베이지/크림색 */
    background-color: #FFF4C9; 
    
    /* [변경 3] 테두리 추가: 약간 진한 베이지색 테두리로 눈에 띄게 함 */
    border: 1px solid #F2E2B1;
    
    padding: 4px 8px;
    border-radius: 6px;
    margin-bottom: 8px;
    
    /* [추가] 약간의 그림자로 입체감 부여 (선택 사항) */
    /* box-shadow: 0 1px 2px rgba(107, 91, 69, 0.1); */
}
.card-title { margin: 0 0 12px 0; font-size: 16px; font-weight: 700; color: #101828; }
.card-body ul { padding-left: 20px; margin: 0; }
.card-body li { font-size: 14px; color: #475467; margin-bottom: 4px; line-height: 1.5; }

/* 카드 푸터 (자세히보기 + 공유하기) */
.card-footer {
    margin-top: 16px; padding-top: 12px; border-top: 1px solid #F2F4F7;
    display: flex; align-items: center; 
    gap: 10px; /* 버튼 사이 간격 */
}

/* 공통 스타일 */
.detail-link, .card-share-btn {
    display: flex; 
    align-items: center; 
    justify-content: center; 
    gap: 6px;
    
    height: 42px; /* 높이 강제 고정 */
    box-sizing: border-box;
    
    background-color: #F2F4F7; 
    border-radius: 12px;
    
    font-size: 14px; 
    font-weight: 600; 
    color: #475467; 
    text-decoration: none;
    cursor: pointer; 
    transition: background-color 0.2s;
    
    flex: 1; /* 50:50 비율 */
}

.detail-link:hover, .card-share-btn:hover {
    background-color: #E4E7EC;
    color: #101828;
}

/* 자세히 보기 (a 태그) */
.detail-link {
    border: none; 
}
.detail-link::before {
    content: ""; 
    display: block;
    width: 16px;
    height: 16px;
    background-image: url("/static/link-icon.png"); 
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    opacity: 0.7;
}

/* [핵심 수정] 공유하기 버튼 (테두리 제거) */
.card-share-btn {
    font-family: inherit; 
    margin: 0;

    /* ★ 여기가 중요합니다! 기본 테두리와 그림자를 없앱니다 ★ */
    border: none; 
    box-shadow: none;
    outline: none;
}
.card-share-btn::before {
    content: ""; display: block; width: 16px; height: 16px;
    background-image: url("/static/share-icon.png"); 
    background-repeat: no-repeat; background-size: contain; opacity: 0.7;
}


/* 6. 입력창 영역 */
.chat-input-box {
    /* [유지] 화면 하단에 고정 */
    position: fixed; 
    bottom: 0; 
    
    /* [추가] PC 화면에서 너무 퍼지지 않게 중앙 정렬 */
    left: 50%;
    transform: translateX(-50%);
    
    /* [추가] 채팅창 너비(600px)와 똑같이 맞춤 */
    width: 100%;
    max-width: 600px; 
    
    z-index: 100;
    background-color: var(--glass-bg);
    backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
    border-top: 1px solid rgba(0,0,0,0.05);
    padding: 10px 16px; padding-bottom: calc(10px + env(safe-area-inset-bottom));
    display: flex; gap: 10px; align-items: center;
}
#user-input {
    flex: 1; height: 46px; border: none; border-radius: 23px; padding: 0 18px;
    font-size: 15px; background-color: rgba(153, 153, 153, 0.2); color: var(--text-primary); outline: none;
    box-shadow: none; transition: background-color 0.2s;
}
#user-input:focus { background-color: rgba(153, 153, 153, 0.1); }

#send-btn, #mic-btn {
    width: 46px; height: 46px; border: none; background-color: transparent;
    cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 0; flex-shrink: 0;
}
#send-btn::after {
    content: ""; display: block; width: 34px; height: 34px;
    background-image: url("/static/send-icon.png"); background-repeat: no-repeat; background-size: contain;
}
#mic-btn::after {
    content: ""; display: block; width: 28px; height: 28px;
    background-image: url("/static/mic-icon.png"); background-repeat: no-repeat; background-size: contain;
}
@keyframes pulse-red { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }
#mic-btn.listening::after { animation: pulse-red 1.5s infinite; filter: invert(21%) sepia(93%) saturate(6863%) hue-rotate(357deg) brightness(103%) contrast(118%); }

/* --- [수정] 피드백 컨테이너 (중앙 정렬 확실하게) --- */
.feedback-container {
    margin-top: 30px; /* 여백 확보 */
    padding-top: 20px; 
    border-top: 1px dashed #E4E7EC;
    display: flex; 
    flex-direction: column; /* 세로 정렬 */
    align-items: center; /* 가로 중앙 */
    justify-content: center;
    gap: 15px;
    width: 100%; /* 전체 너비 사용 */
}

.feedback-container p {
    /* [수정] 크기 축소: 14px -> 12px */
    font-size: 12px; 
    
    /* [수정] 굵기 얇게: 600(Bold) -> 400(Normal) */
    font-weight: 400; 
    
    /* [수정] 색상 변경: 은은한 회색 (#98A2B3) */
    color: #98A2B3; 
    
    margin: 0;
    margin-bottom: 4px; /* 버튼과의 간격 살짝 둠 */
    text-align: center;
}

/* 피드백 버튼 그룹 */
.feedback-btn-group {
    display: flex; gap: 20px; /* 버튼 사이 간격 넓힘 */
}

/* 피드백 버튼 (크기 축소) */
.feedback-btn-link {
    display: flex; 
    align-items: center; 
    justify-content: center;
    
    text-decoration: none; 
    
    /* [수정] 이모지 크기 축소 (24px -> 18px) */
    font-size: 18px; 
    
    /* [수정] 버튼 전체 크기 축소 (48px -> 36px) */
    width: 36px; 
    height: 36px; 
    
    cursor: pointer; 
    opacity: 0.7; 
    background-color: #FFFFFF; 
    border: 1px solid #E4E7EC; /* 테두리도 살짝 얇게(2px->1px) 하면 더 깔끔함 */
    border-radius: 50%; 
    transition: all 0.2s;
}

/* 호버 효과 */
.feedback-btn-link:hover { 
    opacity: 1; 
    border-color: var(--accent-color); 
    background-color: #FFF4C9; 
    transform: scale(1.1); 
}

.feedback-btn-link::before { content: none !important; }

/* 추천 질문 컨테이너 */
.suggestion-container {
    position: absolute;
    bottom: 80px; /* 입력창 높이만큼 띄움 */
    left: 0;
    right: 0;
    z-index: 90;
    
    display: flex;
    gap: 8px;
    padding: 10px 16px;
    
    /* 가로 스크롤 설정 */
    overflow-x: auto;
    white-space: nowrap;
    
    /* 스크롤바 숨김 */
    -ms-overflow-style: none; 
    scrollbar-width: none;
    
    /* 배경 그라데이션 (위쪽은 투명하게) */
    background: linear-gradient(to top, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%);
}
.suggestion-container::-webkit-scrollbar { display: none; }

/* 알약 버튼 스타일 */
.suggestion-chip {
    flex-shrink: 0; /* 찌그러짐 방지 */
    background-color: #FFFFFF;
    border: 1px solid #E4E7EC;
    border-radius: 20px;
    padding: 8px 14px;
    
    font-size: 13px;
    font-weight: 500;
    color: #475467;
    
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.03);
    transition: all 0.2s;
}

.suggestion-chip:hover {
    background-color: #F9FAFB;
    border-color: var(--accent-color);
    color: #101828;
    transform: translateY(-2px);
}

.suggestion-chip:active {
    transform: scale(0.95);
}

/* style.css 추가 */

/* 토글 버튼 (입력창 우측 상단에 배치) */
#suggestion-toggle-btn {
    position: fixed;
    bottom: 86px; /* 입력창(약 80px) 바로 위 */
    right: 10px;  /* 오른쪽 여백 */
    z-index: 95;  /* 추천 컨테이너보다 위 */
    
    width: 32px; height: 32px;
    background-color: transparent; /* 투명 배경 */
    border: none;
    cursor: pointer;
    
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.3s ease; /* 회전 애니메이션 */
    
    /* 터치 영역 확보 */
    padding: 5px;
}

/* 화살표 아이콘 */
#suggestion-toggle-btn::after {
    content: ""; display: block; width: 100%; height: 100%;
    background-image: url("/static/toggle-icon.png"); /* 업로드한 파일명 */
    background-repeat: no-repeat; background-position: center; background-size: contain;
    opacity: 0.6; /* 회색빛 불투명도 */
}

/* 버튼이 눌렸을 때 (활성화) -> 화살표 뒤집기 */
#suggestion-toggle-btn.active {
    transform: rotate(180deg); /* 180도 회전 (아래로) */
}


/* 추천 컨테이너 수정 (애니메이션 지원) */
.suggestion-container {
    /* 기존 위치 유지 */
    position: fixed; bottom: 76px; left: 50%; transform: translateX(-50%);
    width: 100%; max-width: 600px; z-index: 90;
    display: flex; gap: 8px; padding: 10px 16px 15px 16px;
    overflow-x: auto; white-space: nowrap;
    background: linear-gradient(to top, rgba(255,255,255,1) 30%, rgba(255,255,255,0) 100%);
    
    /* [신규] 부드러운 등장/퇴장 효과 */
    transition: all 0.3s ease-in-out;
    opacity: 1;
    pointer-events: auto; /* 클릭 가능 */
}

/* 숨김 상태 (.hidden 클래스가 붙으면) */
.suggestion-container.hidden {
    opacity: 0; /* 투명해짐 */
    transform: translate(-50%, 20px); /* 아래로 살짝 내려감 */
    pointer-events: none; /* 클릭 불가능 (뒤에 있는 채팅창 터치 가능하게) */
}

/* 기타 */
.spinner { width: 20px; height: 20px; border: 2px solid #E4E7EC; border-top-color: var(--accent-color); border-radius: 50%; animation: spin 0.8s linear infinite; display: inline-block; vertical-align: middle; margin-right: 8px; }
@keyframes spin { to { transform: rotate(360deg); } }
.loading-text { font-size: 14px; color: var(--text-secondary); }
.button-container { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 4px; }
.clarify-btn { padding: 6px 12px; font-size: 13px; background-color: #FFFFFF; border: 1px solid #D0D5DD; border-radius: 16px; color: #344054; cursor: pointer; }